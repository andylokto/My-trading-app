<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆ‘çš„äº¤æ˜“åŠ©æ‰‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #121212; color: #e0e0e0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        input { background-color: #1e1e1e; border: 1px solid #333; color: white; border-radius: 8px; padding: 10px; width: 100%; }
        .card { background-color: #1e1e1e; border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-bold mb-6 text-center text-blue-400">ğŸ“ˆ äº¤æ˜“é¢¨éšªè¨ˆç®—å™¨</h1>
        
        <div class="card mb-6">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-1">ç¸½è³‡é‡‘ (USD)</label>
                    <input type="number" id="capital" value="10000" oninput="calculate()">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm text-gray-400 mb-1">é¢¨éšª %</label>
                        <input type="number" id="riskPercent" value="1" oninput="calculate()">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-400 mb-1">å–®ç­†é¢¨éšªé¡</label>
                        <div id="riskAmountDisplay" class="py-2 text-lg font-bold text-red-400">$100</div>
                    </div>
                </div>
                <hr class="border-gray-700">
                <div>
                    <label class="block text-sm text-gray-400 mb-1">é€²å ´åƒ¹</label>
                    <input type="number" id="entry" placeholder="0.00" oninput="calculate()">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">æ­¢æåƒ¹</label>
                    <input type="number" id="stopLoss" placeholder="0.00" oninput="calculate()">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-1">æ­¢è³ºåƒ¹ (ç›®æ¨™)</label>
                    <input type="number" id="takeProfit" placeholder="0.00" oninput="calculate()">
                </div>
            </div>
        </div>

        <div class="card bg-blue-900/20 border border-blue-800 mb-6">
            <div class="grid grid-cols-2 gap-4 text-center">
                <div>
                    <p class="text-xs text-blue-300 uppercase">å»ºè­°è‚¡æ•¸</p>
                    <p id="suggestedQty" class="text-2xl font-black text-white">0</p>
                </div>
                <div>
                    <p class="text-xs text-blue-300 uppercase">é¢¨éšªå›å ±æ¯” (RRR)</p>
                    <p id="rrrDisplay" class="text-2xl font-black text-white">0.0</p>
                </div>
            </div>
        </div>

        <button onclick="saveTrade()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">
            å„²å­˜äº¤æ˜“ç´€éŒ„ (æœ¬åœ°)
        </button>

        <div id="history" class="mt-8 space-y-3">
            <h2 class="text-lg font-bold text-gray-300">æœ€è¿‘ç´€éŒ„ (LocalStorage)</h2>
            </div>
    </div>

    <script>
       // åˆå§‹åŒ–ï¼šé é¢è¼‰å…¥æ™‚è®€å–æœ¬åœ°ç´€éŒ„
window.onload = function() {
    displayHistory();
};

function calculate() {
    const capital = parseFloat(document.getElementById('capital').value) || 0;
    const riskPercent = parseFloat(document.getElementById('riskPercent').value) || 0;
    const entry = parseFloat(document.getElementById('entry').value) || 0;
    const stopLoss = parseFloat(document.getElementById('stopLoss').value) || 0;
    const takeProfit = parseFloat(document.getElementById('takeProfit').value) || 0;

    const riskAmount = capital * (riskPercent / 100);
    document.getElementById('riskAmountDisplay').innerText = `$${riskAmount.toFixed(2)}`;

    if (entry && stopLoss && entry !== stopLoss) {
        const perShareRisk = Math.abs(entry - stopLoss);
        const qty = Math.floor(riskAmount / perShareRisk);
        document.getElementById('suggestedQty').innerText = qty;

        if (takeProfit) {
            const reward = Math.abs(takeProfit - entry);
            const rrr = (reward / perShareRisk).toFixed(2);
            const display = document.getElementById('rrrDisplay');
            display.innerText = `1 : ${rrr}`;
            // RRR é«˜æ–¼ 2 é¡¯ç¤ºç¶ è‰²ï¼Œå¦å‰‡ç´…è‰²
            display.style.color = rrr >= 2 ? "#4ade80" : "#f87171";
        }
    }
}

function saveTrade() {
    const trade = {
        id: Date.now(),
        date: new Date().toLocaleDateString(),
        entry: document.getElementById('entry').value,
        stopLoss: document.getElementById('stopLoss').value,
        rrr: document.getElementById('rrrDisplay').innerText,
        qty: document.getElementById('suggestedQty').innerText
    };

    // å¾ LocalStorage è®€å–èˆŠç´€éŒ„ï¼Œè‹¥ç„¡å‰‡å»ºæ–°é™£åˆ—
    let history = JSON.parse(localStorage.getItem('tradeHistory') || '[]');
    history.unshift(trade); // åŠ å…¥åˆ°æœ€å‰é¢
    localStorage.setItem('tradeHistory', JSON.stringify(history));

    displayHistory();
    alert('ç´€éŒ„å·²æˆåŠŸå­˜å…¥ iPadï¼');
}

function displayHistory() {
    const history = JSON.parse(localStorage.getItem('tradeHistory') || '[]');
    const container = document.getElementById('history');
    container.innerHTML = '<h2 class="text-lg font-bold text-gray-300">æœ€è¿‘ç´€éŒ„</h2>';

    history.forEach(item => {
        const div = document.createElement('div');
        div.className = "card mb-2 text-sm flex justify-between items-center border-l-4 border-blue-500";
        div.innerHTML = `
            <div>
                <p class="font-bold">${item.date} - å»ºè­°è²·å…¥ ${item.qty} è‚¡</p>
                <p class="text-gray-400">é€²å ´: ${item.entry} | æ­¢æ: ${item.stopLoss}</p>
            </div>
            <div class="text-right">
                <p class="text-blue-400 font-bold">${item.rrr}</p>
            </div>
        `;
        container.appendChild(div);
    });
}

    </script>
</body>
</html>
